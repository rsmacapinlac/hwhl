# ============================================
# Terraform Variables for hwhl Homelab
# Generated by Ansible on {{ ansible_facts['date_time']['iso8601'] }}
# ============================================

# ============================================
# Proxmox Connection
# ============================================

proxmox_endpoint  = "https://{{ hostvars[ansible_play_hosts[0]]['ansible_host'] | default(hostvars[ansible_play_hosts[0]]['inventory_hostname']) }}:8006"
{% if terraform_token_output is defined and terraform_token_output is changed %}
proxmox_api_token = "{{ terraform_full_token_id }}={{ terraform_api_token }}"
{% else %}
proxmox_api_token = "terraform@pam!terraform=REPLACE-WITH-YOUR-TOKEN"
{% endif %}
proxmox_insecure  = true
proxmox_host      = "{{ hostvars[ansible_play_hosts[0]]['ansible_host'] | default(hostvars[ansible_play_hosts[0]]['inventory_hostname']) }}"

# ============================================
# Global Settings
# ============================================

homelab_domain     = "{{ homelab_domain }}"
timezone           = "{{ timezone }}"
default_gateway    = "{{ default_gateway | default('10.1.0.1') }}"
default_nameserver = "1.1.1.1"  # Will point to local DNS after initial setup
root_password      = "{{ lxc_root_password | default('CHANGE-ME-SECURE-PASSWORD') }}"

# ============================================
# SSH Configuration
# ============================================

ssh_public_key_file = "~/.ssh/id_rsa_homelab_terraform.pub"

# ============================================
# LXC Template
# ============================================

debian_template = "local:vztmpl/debian-12-standard_12.12-1_amd64.tar.zst"
datastore       = "local-lvm"
network_bridge  = "vmbr0"

# ============================================
# DNS Containers
# ============================================
# Update these with your desired configuration

dns_containers = {
  "dns-01" = {
    vmid       = 301
    node       = "pve-01"
    ip_address = "10.1.0.2/24"
    gateway    = "{{ default_gateway | default('10.1.0.1') }}"
    nameserver = "1.1.1.1, 1.0.0.1"
    memory     = 2048
    swap       = 4096
    cores      = 1
    disk_size  = 32
    mount_points = []  # No mount points for DNS containers
  }
  "dns-02" = {
    vmid       = 302
    node       = "pve-01"
    ip_address = "10.1.0.3/24"
    gateway    = "{{ default_gateway | default('10.1.0.1') }}"
    nameserver = "1.1.1.1, 1.0.0.1"
    memory     = 2048
    swap       = 4096
    cores      = 1
    disk_size  = 32
    mount_points = []  # No mount points for DNS containers
  }
}

# ============================================
# Edge Service Containers
# ============================================
# Traefik, Authelia, Cloudflare DDNS, WireGuard

edge_containers = {
  "edge-01" = {
    vmid       = 400
    node       = "pve-01"
    ip_address = "10.1.0.10/24"
    gateway    = "{{ default_gateway | default('10.1.0.1') }}"
    nameserver = "10.1.0.3, 10.1.0.2"  # Use local DNS container
    memory     = 4096
    swap       = 8192
    cores      = 1
    disk_size  = 64
    # Mount NFS shares from Proxmox host into container
    # These paths must exist on the Proxmox host (mounted via Ansible)
    mount_points = [
      # Example: Mount ContainerBackups NFS share
      # {
      #   host_path      = "/mnt/ContainerBackups"  # Path on Proxmox host (from proxmox_nfs_shares)
      #   container_path  = "/mnt/backups"           # Path inside container
      # }
    ]
  }
}


